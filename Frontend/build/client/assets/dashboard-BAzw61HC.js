import{w as U}from"./with-props-DSW1myl8.js";import{r as p,j as e}from"./chunk-DQRVZFIR-CtLrds9g.js";import{c as u}from"./createLucideIcon-DpBpHvh4.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],X=u("brain",W);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],J=u("circle-check-big",G);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Q=u("code",K);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],Y=u("message-circle",V);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],te=u("user-check",ee);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ne=u("users",se);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ce=u("x",ae),oe=({applications:o})=>{console.log("DashFunnel received applications:",o);const j=o.filter(t=>t.status.toLowerCase()==="rejected");console.log("Rejected apps in funnel:",j),j.forEach(t=>{console.log(`App ${t.company_name}: previous_status = ${t.previous_status}`)});const[d,h]=p.useState([]),v=[{key:"applied",name:"Applied",icon:ne,color:"bg-blue-500",bgColor:"bg-blue-50"},{key:"cognitive testing",name:"Cognitive Tests",icon:X,color:"bg-purple-500",bgColor:"bg-purple-50"},{key:"interview",name:"Digital Interview",icon:Y,color:"bg-emerald-500",bgColor:"bg-emerald-50"},{key:"code exam",name:"Code Exam",icon:Q,color:"bg-cyan-500",bgColor:"bg-cyan-50"},{key:"physical interview",name:"Physical Interview",icon:te,color:"bg-indigo-500",bgColor:"bg-indigo-50"},{key:"offer",name:"Offer",icon:J,color:"bg-green-500",bgColor:"bg-green-50"}];p.useEffect(()=>{o&&o.length>0&&k()},[o]);const k=()=>{const t=o.length;if(t===0){h([]);return}let r=0,n=0,s=0,a=0,l=0,b=0,y=0,N=0,C=0,w=0,A=0,_=0,M=0,F=0,E=0,I=0,R=0,$=0;function q(c){var x;const i=((x=c.previous_status)==null?void 0:x.toLowerCase())||"applied";switch(console.log("Rejected app:",c.company_name,"previous_status:",c.previous_status,"normalized:",i),r++,i){case"applied":M++;break;case"cognitivetesting":n++,F++;break;case"digitalinterview":n++,s++,E++;break;case"codeexam":n++,s++,a++,I++;break;case"interview":n++,s++,a++,l++,R++;break;case"offer":n++,s++,a++,l++,b++,$++;break}}function S(c,i){switch(console.log("Processing status:",i),r++,i){case"applied":y++;break;case"cognitivetesting":n++,N++;break;case"digitalinterview":n++,s++,C++;break;case"codeexam":n++,s++,a++,w++;break;case"interview":n++,s++,a++,l++,A++;break;case"offer":n++,s++,a++,l++,b++,_++;break;default:y++;break}}function z(){const c=[r,n,s,a,l,b],i=[y,N,C,w,A,_],x=[M,F,E,I,R,$];return v.map((O,m)=>{const f=c[m],B=i[m],D=x[m],H=t>0?f/t*100:0;let L=100;if(m>0){const P=c[m-1];L=P>0?f/P*100:0}const Z=f>0?D/f*100:0;return{...O,count:B,rejectedCount:D,totalReached:f,percentage:Math.round(H*10)/10,conversionFromPrevious:Math.round(L*10)/10,rejectionRate:Math.round(Z*10)/10}})}o.forEach(c=>{const i=c.status.toLowerCase();console.log("Decider for function to use:",i),i==="rejected"?q(c):S(c,i)}),console.log("Debug counts:",{appliedCount:r,cognitiveCount:n,currentCognitive:N,currentApplied:y,applications:o.map(c=>({status:c.status,previous_status:c.previous_status}))});const T=z();h(T)},g=t=>`${Math.max(t,2)}%`;return d.length?e.jsx("div",{className:"funnel-container",children:e.jsx("div",{className:"funnel-stages",children:d.map((t,r)=>{const n=t.icon,s=r===0,a=r===d.length-1,l=!a&&r<d.length-1?d[r+1].totalReached:0;return e.jsxs("div",{className:"funnel-stage-wrapper",children:[e.jsxs("div",{className:`funnel-stage funnel-stage-${t.key.replace(/\s+/g,"-")}`,children:[e.jsx("div",{className:`funnel-progress funnel-progress-${t.key.replace(/\s+/g,"-")}`,style:{width:g(t.percentage)}}),e.jsxs("div",{className:"funnel-content",children:[e.jsxs("div",{className:"funnel-left",children:[e.jsx("div",{className:`funnel-icon funnel-icon-${t.key.replace(/\s+/g,"-")}`,children:e.jsx(n,{size:16})}),e.jsxs("div",{className:"funnel-details",children:[e.jsx("h4",{className:"funnel-stage-name",children:t.name}),e.jsxs("div",{className:"funnel-metrics",children:[t.count>0&&e.jsxs("span",{className:"funnel-current",children:[t.count," currently here"]}),!a&&l>0&&e.jsxs("span",{className:"funnel-passed",children:[l," advanced"]}),t.rejectedCount>0&&e.jsxs("span",{className:"funnel-rejected",children:[t.rejectedCount," rejected"]}),!s&&e.jsxs("span",{className:"funnel-conversion",children:[t.conversionFromPrevious,"% conversion rate from previous stage"]}),t.rejectedCount>0&&t.totalReached>0&&e.jsxs("span",{className:"funnel-rejection",children:[Math.round(t.rejectedCount/t.totalReached*100),"% rejected here"]}),a&&t.totalReached>0&&e.jsxs("span",{className:"funnel-completion",children:["Success rate: ",t.percentage,"%"]})]})]})]}),e.jsxs("div",{className:"funnel-right",children:[e.jsxs("div",{className:"funnel-percentage",children:[t.percentage,"%"]}),e.jsxs("div",{className:"funnel-total",children:[t.totalReached," total reached"]})]})]})]}),r<d.length-1&&e.jsx("div",{className:"funnel-connector",children:e.jsx("div",{className:"funnel-connector-dot",children:e.jsx("div",{className:"funnel-connector-inner"})})})]},t.key)})})}):e.jsx("div",{className:"funnel-no-data",children:"No application data to display"})},re=()=>{const[o,j]=p.useState([]),[d,h]=p.useState(!0),[v,k]=p.useState(""),g=async()=>{try{h(!0);const s=localStorage.getItem("token"),a=await fetch("http://localhost:5000/api/auth/ApplicationData",{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to fetch applications");const l=await a.json();j(l.applications||[])}catch(s){console.error("Error fetching applications:",s),k("Failed to load applications")}finally{h(!1)}};p.useEffect(()=>{g()},[]);const t=o.length,r=o.filter(s=>s.status.toLowerCase()==="interview").length,n=o.filter(s=>s.status.toLowerCase()==="offer").length;return d?e.jsx("div",{className:"background-container loading-container",children:e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading your dashboard..."})]})}):v?e.jsx("div",{className:"background-container error-container",children:e.jsxs("div",{className:"error-content",children:[e.jsx(ce,{size:48,className:"error-icon"}),e.jsx("p",{className:"error-message",children:v}),e.jsx("button",{onClick:g,className:"retry-button",children:"Retry"})]})}):e.jsx("div",{className:"background-container",children:e.jsxs("div",{className:"dashboard-grid",children:[e.jsx("section",{className:"dashboard-title",children:e.jsx("h1",{children:"Hey there, welcome to your dashboard!"})}),e.jsx("section",{className:"stats-section",children:e.jsxs("div",{className:"stats-container",children:[e.jsxs("div",{className:"stats-box",children:[e.jsx("h3",{children:"Total Applications"}),e.jsx("p",{className:"totalApplications",children:t})]}),e.jsxs("div",{className:"stats-box",children:[e.jsx("h3",{children:"Total Interviews"}),e.jsx("p",{className:"totalApplications",children:r})]}),e.jsxs("div",{className:"stats-box",children:[e.jsx("h3",{children:"Total Offers"}),e.jsx("p",{className:"totalApplications",children:n})]})]})}),e.jsx("section",{className:"applications-section separate",children:e.jsx("div",{className:"applications-container",children:e.jsx(oe,{applications:o})})})]})})},ue=U(re);export{ue as default};
